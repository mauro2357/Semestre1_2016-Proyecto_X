package repositorios;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import LogicaNegocio.Usuarios;

public class ConsultarDatos {
	
	public int consultarCantidad() {
        Connection con;
        Statement st;
        try {
            Class.forName("com.mysql.jdbc.Driver");
            con = DriverManager.getConnection("jdbc:mysql://localhost:3306/bd_manager_fitness", "root", "root");
            st = con.createStatement();
            String consulta= ("select count(*) as cantidad from bd_mananger_fitness.usuarios;");  
            ResultSet miconsulta = con.ejecutarSQLSelect(consulta);
        }catch (SQLException e){
        	System.out.println("entro en el catch");
        	e.printStackTrace();
        	return false;
        }catch (ClassNotFoundException e){
        	e.printStackTrace();
            System.out.println("La clase no existe");
            return false;
        }
        return true;
    }
	
	public ResultSet ejecutarSQLSelect(String select) {
		ResultSet resultado; 
	   	try {
	   	    Statement sentencia = (Statement) con.createStatement();
	   	    resultado = sentencia.executeQuery(select);
	   	} catch (SQLException ex) {
	   		return null;
	   	}
	   	return resultado;
	}
	
	
	
	
	
	
}      
             
            
            
            if(miconsulta.next()){
          	  int cant = miconsulta.getInt("cantidad");
          	  System.out.println(cant);
                return cant;
            }
        } 
             catch (SQLException ex){
		Logger.getLogger(inicio.class.getName()).log(Level.SEVERE, null, ex);
		return 0;
              }
		return 0;
  }



	
}
